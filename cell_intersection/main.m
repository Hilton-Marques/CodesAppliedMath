clc;
clear;
close all;

addpath("CellIntersection\","ConvexCell\","Drawer\","GJK\","QuickHull\");


% cell 572 and 53067
pts_572 = [3151.57812 -2008.25000 -3190.63989 ; ...
3100.35938 -1921.25000 -3192.01001 ; ...
3064.98438 -2062.25000 -3172.59009 ; ...
3013.79688 -1975.25000 -3175.23999 ; ...
3151.57812 -2008.25000 -3197.63989 ; ...
3100.35938 -1921.25000 -3199.01001 ; ...
3064.98438 -2062.25000 -3179.59009 ; ...
3013.79688 -1975.25000 -3182.23999 ];

pts_53067 = [3085.82812  -1954.75000  -3179.82007 ; ...
2997.82812  -1904.75000  -3174.13989 ; ...
3037.82812  -2044.75000  -3179.85010 ; ...
2949.82812  -1994.75000  -3173.11011 ; ...
3085.82812  -1954.75000  -3179.82007 ; ...
2997.82812  -1904.75000  -3174.13989 ; ...
3037.82812  -2044.75000  -3181.20996 ; ...
2949.82812  -1994.75000  -3174.10010 ];

%cell 146 and 4132
pts_146 = [3007.82812  -805.250000  -3230.40991 ; ...
2957.48438  -718.750000  -3223.41992 ; ...
2921.26562  -859.250000  -3229.18994 ; ...
2870.92188  -772.750000  -3221.79004 ; ...
3007.82812  -805.250000  -3237.40991 ; ...
2957.48438  -718.750000  -3230.41992 ; ...
2921.26562  -859.250000  -3236.18994 ; ...
2870.92188  -772.750000  -3228.79004 ];

pts_4132 = [2999.82812 -654.750000 -3234.76001 ; ...
2911.82812 -604.750000 -3226.10010 ; ...
2951.82812 -744.750000 -3220.13989 ; ...
2863.82812 -694.750000 -3213.43994 ; ...
2999.82812 -654.750000 -3241.76001 ; ...
2911.82812 -604.750000 -3233.10010 ; ...
2951.82812 -744.750000 -3227.13989 ; ...
2863.82812 -694.750000 -3220.43994 ];

pts_1 = pts_572;
pts_2 = pts_53067;
threshold = 0.03;
[cell_intersection_obj,volume] = CellIntersection(pts_1,pts_2,threshold);
